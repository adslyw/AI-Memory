#!/bin/bash\n\nLOG_FILE="memory/system_health.log"\nTEMP_SOURCE=""\n\n# 尝试找到 CPU 温度的读取方式\nif command -v sensors &gt; /dev/null 2&gt;&amp;1; then\n    # 使用 sensors 命令，找到最常见的 CPU 温度行（如 Core 0, Package id 0, temp1）\n    # 这里的 grep 模式可能需要针对不同硬件进行调整\n    TEMP_OUTPUT=$(sensors | grep -iE \'Core 0|Package id 0|temp1\' | head -n 1)\n    if [[ "$TEMP_OUTPUT" =~ \+([0-9]+\.[0-9]+) ]]; then\n        TEMP_VALUE=$(echo "${BASH_REMATCH[1]}" | awk \'{printf "%.0f", $1}\') # 提取整数温度, e.g., 45\n        TEMP_SOURCE="sensors"\n    fi\nelif [ -f "/sys/class/thermal/thermal_zone0/temp" ]; then\n    # 备用方案：读取 /sys/class/thermal/thermal_zone0/temp\n    # 这个文件中的值通常是毫摄氏度，需要除以1000\n    TEMP_RAW=$(cat "/sys/class/thermal/thermal_zone0/temp")\n    TEMP_VALUE=$(($TEMP_RAW / 1000)) # 转换为摄氏度整数\n    TEMP_SOURCE="sysfs"\nfi\n\n# 如果未能获取到温度，则记录为 N/A\nif [ -z "$TEMP_VALUE" ]; then\n    CPU_TEMP="N/A"\nelse\n    CPU_TEMP="$TEMP_VALUE"\nfi\n\n# 获取空闲内存 (以 MB 为单位)\nFREE_MEM_MB=$(free -m | grep Mem: | awk \'{print $4}\')\n\n# 创建 memory 目录（如果不存在）。\nmkdir -p "$(dirname "$LOG_FILE")"\n\n# 记录日志，格式：时间, CPU温度(°C, source), 空闲内存(MB)\necho "$(date "+%Y-%m-%d %H:%M:%S"), CPU_Temp=${CPU_TEMP}°C (${TEMP_SOURCE:-unknown}), Free_Mem_MB=${FREE_MEM_MB}" >> "$LOG_FILE"\n